{"version":3,"sources":["../../../../src/Adapters/Storage/Postgres/PostgresClient.js"],"names":["createClient","parser","require","uri","databaseOptions","dbOptions","getDatabaseOptionsFromURI","key","initOptions","pgp","client","pgOptions","pg","defaults"],"mappings":";;;;;QAGgBA,Y,GAAAA,Y;;AAFhB,MAAMC,SAASC,QAAQ,wBAAR,CAAf;;AAEO,SAASF,YAAT,CAAsBG,GAAtB,EAA2BC,eAA3B,EAA4C;AACjD,MAAIC,YAAY,EAAhB;AACAD,oBAAkBA,mBAAmB,EAArC;;AAEA,MAAID,GAAJ,EAAS;AACPE,gBAAYJ,OAAOK,yBAAP,CAAiCH,GAAjC,CAAZ;AACD;;AAED,OAAK,MAAMI,GAAX,IAAkBH,eAAlB,EAAmC;AACjCC,cAAUE,GAAV,IAAiBH,gBAAgBG,GAAhB,CAAjB;AACD;;AAED,QAAMC,cAAcH,UAAUG,WAAV,IAAyB,EAA7C;AACA,QAAMC,MAAMP,QAAQ,YAAR,EAAsBM,WAAtB,CAAZ;AACA,QAAME,SAASD,IAAIJ,SAAJ,CAAf;;AAEA,MAAIA,UAAUM,SAAd,EAAyB;AACvB,SAAK,MAAMJ,GAAX,IAAkBF,UAAUM,SAA5B,EAAuC;AACrCF,UAAIG,EAAJ,CAAOC,QAAP,CAAgBN,GAAhB,IAAuBF,UAAUM,SAAV,CAAoBJ,GAApB,CAAvB;AACD;AACF;;AAED,SAAO,EAAEG,MAAF,EAAUD,GAAV,EAAP;AACD","file":"PostgresClient.js","sourcesContent":["\nconst parser = require('./PostgresConfigParser');\n\nexport function createClient(uri, databaseOptions) {\n  let dbOptions = {};\n  databaseOptions = databaseOptions || {};\n\n  if (uri) {\n    dbOptions = parser.getDatabaseOptionsFromURI(uri);\n  }\n\n  for (const key in databaseOptions) {\n    dbOptions[key] = databaseOptions[key];\n  }\n\n  const initOptions = dbOptions.initOptions || {};\n  const pgp = require('pg-promise')(initOptions);\n  const client = pgp(dbOptions);\n\n  if (dbOptions.pgOptions) {\n    for (const key in dbOptions.pgOptions) {\n      pgp.pg.defaults[key] = dbOptions.pgOptions[key];\n    }\n  }\n\n  return { client, pgp };\n}\n"]}